<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PillPall - Profile</title>
    <link rel="stylesheet" href="style.css" />
    <script defer src="script.js"></script>
  </head>
  <body>
    <header>
      <nav class="navbar">
        <h1 class="logo" onclick="window.location.href='index.html'">
          PillPall
        </h1>
        <div class="menu-toggle">â˜°</div>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="timetable.html">Timetable</a></li>
          <li><a href="profile.html">Profile</a></li>
          <li><a href="medicine.html">Medicine</a></li>
          <li><a href="account.html">Account</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="spare.html">Spare</a></li>
        </ul>
        <div class="account-btn">
          <button id="loginBtn" onclick="handleLoginClick()">Login</button>
        </div>
      </nav>
    </header>

    <main>
      <div class="content-box profile-section">
        <h2>Profile</h2>
        <p class="muted">
          Manage your basic profile information. Data is saved locally in your
          browser.
        </p>

        <form id="profileForm" class="profile-form">
          <label for="name">Name</label>
          <input
            id="name"
            name="name"
            type="text"
            placeholder="Your full name"
          />

          <label for="email">Email</label>
          <input
            id="email"
            name="email"
            type="email"
            placeholder="you@example.com"
          />

          <label for="allergies">Allergies</label>
          <input
            id="allergies"
            name="allergies"
            type="text"
            placeholder="e.g. peanuts, penicillin"
          />

          <div style="margin-top: 12px">
            <button id="saveProfile" type="submit">Save Profile</button>
            <button id="clearProfile" type="button" style="margin-left: 8px">
              Clear
            </button>
          </div>
          <div
            id="saveStatus"
            role="status"
            aria-live="polite"
            style="display: inline-block; margin-left: 12px; color: #a8a8a8"
          ></div>
        </form>
      </div>
    </main>

    <script>
      // Inline profile save script to match the simple localStorage behavior used elsewhere
      (function () {
        const STORAGE_KEY = "pillpallProfile";
        function $(id) {
          return document.getElementById(id);
        }

        function load() {
          try {
            const raw = localStorage.getItem(STORAGE_KEY);
            if (raw) {
              const p = JSON.parse(raw);
              $("name").value = p.name || "";
              $("email").value = p.email || "";
              $("allergies").value = p.allergies || "";
            }
          } catch (e) {
            console.warn("Failed to load profile", e);
          }
        }

        function save(e) {
          if (e) e.preventDefault();
          const data = {
            name: $("name").value.trim(),
            email: $("email").value.trim(),
            allergies: $("allergies").value.trim(),
          };
          try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            $("saveStatus").textContent = "Saved";
            setTimeout(() => {
              $("saveStatus").textContent = "";
            }, 2000);
          } catch (err) {
            $("saveStatus").textContent = "Save failed";
            console.error(err);
          }
        }

        function clearProfile() {
          localStorage.removeItem(STORAGE_KEY);
          $("name").value = "";
          $("email").value = "";
          $("allergies").value = "";
          $("saveStatus").textContent = "Cleared";
          setTimeout(() => {
            $("saveStatus").textContent = "";
          }, 1500);
        }

        document.addEventListener("DOMContentLoaded", () => {
          load();
          $("profileForm").addEventListener("submit", save);
          $("clearProfile").addEventListener("click", clearProfile);
        });
      })();
    </script>
  </body>
</html>
